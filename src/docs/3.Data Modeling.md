
# Data Modeling

* @author Thabiso Matsaba
* @email <thabisomatsaba96@gmail.com>
* @create date 10-01-2025 03:03:52
* @modify date 10-01-2025 03:03:52
* @desc Data Modeling

## Cloud Explorer - Firestore Data Model and TypeScript Interfaces

This document outlines the data model for the Cloud Explorer application using Google Cloud Firestore and TypeScript interfaces for better type safety and code maintainability.

## TypeScript Interfaces

We'll define TypeScript interfaces to represent the structure of our Firestore documents. This improves code readability and helps prevent runtime errors.

```typescript
// src/models/User.ts
export interface User {
  uid: string; // Unique ID generated by Firebase Authentication
  email: string;
  displayName: string;
  photoURL?: string; // URL to the user's profile picture (optional)
  createdAt: firebase.firestore.Timestamp; // When the user registered
  lastLogin?: firebase.firestore.Timestamp; // Last login time
  learningProgress: LearningProgress;
  settings: UserSettings;
}

export interface LearningProgress {
  completedModules: string[]; // Array of module IDs the user has completed
  completedQuizzes: string[]; // Array of quiz IDs the user has completed
  completedExams: string[]; // Array of exam IDs the user has completed
  score: number; // Overall score across quizzes and exams
}

export interface UserSettings {
  notificationsEnabled: boolean;
  darkMode: boolean;
}


// src/models/Module.ts
export interface Module {
  moduleId: string; // Unique ID for the module
  title: string;
  description: string;
  content: string; // HTML or Markdown content for the module
  duration: number; // Estimated time to complete the module (in minutes)
  prerequisites?: string[]; // Array of module IDs required to unlock this module (optional)
  quizzes?: string[]; // Array of quiz IDs associated with this module (optional)
  createdAt: firebase.firestore.Timestamp;
  updatedAt: firebase.firestore.Timestamp;
}

// src/models/Quiz.ts
export interface Quiz {
  quizId: string; // Unique ID for the quiz
  moduleId: string; // ID of the associated learning module
  title: string;
  questions: Question[];
  passingScore: number; // Minimum score required to pass the quiz
  createdAt: firebase.firestore.Timestamp;
  updatedAt: firebase.firestore.Timestamp;
}

export interface Question {
  questionId: string; // Unique ID for the question
  questionText: string;
  options: string[]; // Array of answer options
  correctAnswer: string; // Correct answer
  explanation: string; // Explanation for the correct answer
}

// src/models/Exam.ts (similar structure to Quiz)
export interface Exam {
  examId: string; // Unique ID for the exam
  moduleId: string; // ID of the associated learning module
  title: string;
  questions: Question[];
  passingScore: number; // Minimum score required to pass the exam
  createdAt: firebase.firestore.Timestamp;
  updatedAt: firebase.firestore.Timestamp;
}


// src/models/UserProgress.ts
export interface UserProgress {
  userId: string; // ID of the user
  quizId?: string; // ID of the quiz (if applicable)
  examId?: string; // ID of the exam (if applicable)
  score: number; // User's score
  totalQuestions: number; // Total number of questions
  correctAnswers: number; // Number of correct answers
  completedAt: firebase.firestore.Timestamp; // When the quiz/exam was completed
}


// src/models/Notification.ts
export interface Notification {
  notificationId: string; // Unique ID for the notification
  userId: string; // ID of the user receiving the notification
  title: string;
  message: string;
  type: NotificationType; // e.g., "quiz_result", "exam_result", "learning_milestone"
  read: boolean; // Whether the notification has been read
  createdAt: firebase.firestore.Timestamp;
}

export enum NotificationType {
  QUIZ_RESULT = 'quiz_result',
  EXAM_RESULT = 'exam_result',
  LEARNING_MILESTONE = 'learning_milestone',
}


// src/models/AIContent.ts
export interface AIContent {
  contentId: string; // Unique ID for the content
  type: AIContentType; // e.g., "quiz_question", "explanation"
  source: string; // e.g., "GPT-3", "Hugging Face"
  content: string; // The actual content (question, explanation, etc.)
  metadata: AIContentMetadata;
  createdAt: firebase.firestore.Timestamp;
}

export enum AIContentType {
  QUIZ_QUESTION = 'quiz_question',
  EXPLANATION = 'explanation',
  MODULE_CONTENT = 'module_content',
}

export interface AIContentMetadata {
  moduleId?: string; // ID of the associated module (if applicable)
  quizId?: string; // ID of the associated quiz (if applicable)
  examId?: string; // ID of the associated exam (if applicable)
}
```

## Firestore Collections and Structure

The following collections will be used in Firestore:

* **users:** Stores `User` objects.  Document ID is the `uid`.
* **modules:** Stores `Module` objects. Document ID is `moduleId`.
* **quizzes:** Stores `Quiz` objects. Document ID is `quizId`.
* **exams:** Stores `Exam` objects. Document ID is `examId`.
* **notifications:** Stores `Notification` objects. Document ID is `notificationId`.
* **aiContent:** Stores `AIContent` objects. Document ID is `contentId`.

**Note:** The `UserProgress` data could be embedded within the `users` collection (under the `learningProgress` field)  to optimize queries for user progress. This avoids joins and makes retrieving a user's progress more efficient.  If you keep a separate `userProgress` collection, make sure to index `userId`, `quizId`, and `examId` for optimal query performance.

## Relationships

The relationships between collections are primarily handled through referencing IDs (e.g., `moduleId` in `Quiz` references a document in the `modules` collection).

## Security Rules (Example)

The following security rules provide a starting point and should be adjusted based on your specific access control requirements:

```javascripr
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    match /users/{userId} {
      allow read: if request.auth.uid == userId; // User can only read their own data
      allow write: if request.auth.uid == userId; // User can only write their own data
    }
    match /modules/{moduleId} {
      allow read: if request.auth.uid != null; // All authenticated users can read modules
    }
    match /quizzes/{quizId} {
      allow read: if request.auth.uid != null; // All authenticated users can read quizzes
    }
    match /exams/{examId} {
      allow read: if request.auth.uid != null; // All authenticated users can read exams
    }
    match /notifications/{notificationId} {
      allow read: if request.auth.uid != null && resource.data.userId == request.auth.uid; // User can only read their own notifications
    }
    match /aiContent/{contentId} {
        allow read: if request.auth.uid != null; // All authenticated users can read AI content.  Consider more granular rules if necessary.
    }
  }
}
```
